<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Overthinker's Calculator</title>
    <style>
        /* --- 1. SETTINGS & RESET --- */
        :root {
            --bg-color: #0f172a;
            --calc-bg: rgba(30, 41, 59, 0.65);
            --text-main: #f8fafc;
            --text-secondary: #94a3b8;
            --accent-color: #38bdf8;
            --accent-glow: rgba(56, 189, 248, 0.35);
            --btn-bg: rgba(255, 255, 255, 0.03);
            --btn-hover: rgba(255, 255, 255, 0.08);
            --icon-active: #38bdf8;
            --icon-inactive: #475569;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        /* --- 2. LAYOUT & BACKGROUND --- */
        body {
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 10% 10%, rgba(56, 189, 248, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 90% 90%, rgba(139, 92, 246, 0.08) 0%, transparent 40%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        /* --- 3. CALCULATOR CONTAINER --- */
        .calculator {
            background: var(--calc-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 32px;
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.6);
            width: 100%;
            max-width: 380px;
            height: 92vh;
            max-height: 750px;
            padding: 24px;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* --- 4. HEADER & TITLE --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            height: 40px;
        }

        .app-title {
            text-align: center;
            color: var(--text-main);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
            opacity: 0.8;
            text-shadow: 0 0 10px var(--accent-glow);
            font-weight: 600;
        }

        .nav-btn, .toggle-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-secondary);
            transition: transform 0.2s ease, color 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn {
            font-size: 1.5rem;
            padding: 10px;
            margin-left: -10px;
        }

        .controls {
            display: flex;
            gap: 15px;
        }

        .toggle-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .toggle-btn.active {
            color: var(--icon-active);
            filter: drop-shadow(0 0 8px var(--accent-glow));
        }

        .toggle-btn.inactive {
            color: var(--icon-inactive);
        }

        .nav-btn:active, .toggle-btn:active {
            transform: scale(0.9);
        }

        /* --- 5. DISPLAY SCREEN --- */
        .display {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: flex-end;
            margin-bottom: 20px;
            padding-right: 5px;
        }

        .previous-operand {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 5px;
            min-height: 1.5rem;
            opacity: 0.6;
        }

        .current-operand {
            color: var(--text-main);
            font-size: 3.5rem;
            font-weight: 200;
            letter-spacing: -1px;
            line-height: 1.1;
        }

        /* --- 6. BUTTON GRID --- */
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        button.key {
            height: 62px;
            border-radius: 18px;
            border: none;
            background: var(--btn-bg);
            color: var(--text-main);
            font-size: 1.3rem;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.15s ease-out;
            outline: none;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        button.key:hover {
            background: var(--btn-hover);
            transform: translateY(-2px);
        }

        button.key:active {
            transform: scale(0.95) translateY(0);
            background: rgba(255, 255, 255, 0.1);
        }

        .span-two { grid-column: span 2; }
        
        .operator {
            color: var(--accent-color);
            font-size: 1.5rem;
            font-weight: 500;
        }

        .equals {
            background: var(--accent-color);
            color: #0f172a;
            font-weight: 600;
            box-shadow: 0 0 15px var(--accent-glow);
        }
        
        .equals:hover {
            background: #7dd3fc;
            box-shadow: 0 0 25px var(--accent-glow);
        }

        /* --- 7. CALM OVERLAY --- */
        .calm-overlay {
            position: absolute;
            inset: 0;
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 32px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            z-index: 50;
            padding: 40px;
            text-align: center;
        }

        .calm-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .calm-text {
            color: var(--text-main);
            font-size: 1.6rem;
            font-weight: 300;
            line-height: 1.5;
            margin-bottom: 20px;
            animation: breathe 4s ease-in-out infinite;
        }

        .calm-sub {
            color: var(--accent-color);
            font-size: 0.85rem;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            opacity: 0.7;
            margin-top: 30px;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.05); opacity: 1; text-shadow: 0 0 15px var(--accent-glow); }
        }

    </style>
</head>
<body>

    <div class="calculator">
        <div class="calm-overlay" id="calmOverlay">
            <h2 class="calm-text" id="quoteText">Stay calm.</h2>
            <p class="calm-sub">Tap anywhere to return</p>
        </div>

        <div class="header">
            <button class="nav-btn" onclick="goBack()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
            </button>
            
            <div class="controls">
                <button class="toggle-btn active" id="soundBtn" onclick="toggleSound()">
                    <svg viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>
                </button>
                <button class="toggle-btn active" id="hapticBtn" onclick="toggleHaptic()">
                    <svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M22 9h-2V7h2v2zm0 4h-2v-2h2v2zm0 4h-2v-2h2v2zM2 9H0V7h2v2zm0 4H0v-2h2v2zm0 4H0v-2h2v2zm14.78-7.94l-2.83-2.83c-.39-.39-1.02-.39-1.41 0L5.66 9.17c-1.56 1.56-1.56 4.09 0 5.66l6.88 6.88c.39.39 1.02.39 1.41 0l6.88-6.88c1.56-1.57 1.51-4.1-.05-5.67zM16 14h-8v-4h8v4z"/></svg>
                </button>
            </div>
        </div>

        <div class="app-title">Overthinker's Calculator</div>

        <div class="display">
            <div class="previous-operand" data-previous-operand></div>
            <div class="current-operand" data-current-operand>0</div>
        </div>

        <div class="buttons">
            <button class="key span-two" onclick="handleInput('AC', 'clear')">AC</button>
            <button class="key" onclick="handleInput('DEL', 'del')">DEL</button>
            <button class="key operator" onclick="handleInput('รท', 'op')">รท</button>
            
            <button class="key" onclick="handleInput('7', 'num')">7</button>
            <button class="key" onclick="handleInput('8', 'num')">8</button>
            <button class="key" onclick="handleInput('9', 'num')">9</button>
            <button class="key operator" onclick="handleInput('*', 'op')">ร</button>
            
            <button class="key" onclick="handleInput('4', 'num')">4</button>
            <button class="key" onclick="handleInput('5', 'num')">5</button>
            <button class="key" onclick="handleInput('6', 'num')">6</button>
            <button class="key operator" onclick="handleInput('-', 'op')">-</button>
            
            <button class="key" onclick="handleInput('1', 'num')">1</button>
            <button class="key" onclick="handleInput('2', 'num')">2</button>
            <button class="key" onclick="handleInput('3', 'num')">3</button>
            <button class="key operator" onclick="handleInput('+', 'op')">+</button>
            
            <button class="key" onclick="handleInput('.', 'num')">.</button>
            <button class="key" onclick="handleInput('0', 'num')">0</button>
            <button class="key span-two equals" onclick="handleInput('=', 'eq')">=</button>
        </div>
    </div>

    <script>
        /* --- CONFIGURATION --- */
        let settings = {
            sound: true,
            haptic: true
        };

        const quotes = [
            "Stay calm, don't overthink.",
            "Just breathe.",
            "You are exactly where you need to be.",
            "This moment is all there is.",
            "Let go of the 'what ifs'.",
            "Trust the process.",
            "One calculation at a time.",
            "Peace is a choice.",
            "Your mind is a beautiful tool.",
            "Slow down. You're doing fine."
        ];

        /* --- AUDIO CONTEXT --- */
        let audioCtx;

        /* --- UI ELEMENTS --- */
        const prevText = document.querySelector('[data-previous-operand]');
        const currText = document.querySelector('[data-current-operand]');
        const overlay = document.getElementById('calmOverlay');
        const quoteEl = document.getElementById('quoteText');
        const soundBtn = document.getElementById('soundBtn');
        const hapticBtn = document.getElementById('hapticBtn');

        /* --- CALCULATOR STATE --- */
        let currentOperand = '';
        let previousOperand = '';
        let operation = undefined;

        /* --- FUNCTIONS --- */

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        function playSound(type) {
            if (!settings.sound || !audioCtx) return;
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            const now = audioCtx.currentTime;

            if (type === 'click') {
                // Soft fluid pop
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, now);
                osc.frequency.exponentialRampToValueAtTime(300, now + 0.08);
                gain.gain.setValueAtTime(0.2, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
                osc.start(now);
                osc.stop(now + 0.1);
            } else if (type === 'equal') {
                // Gentle chord-like sine
                osc.type = 'sine';
                osc.frequency.setValueAtTime(440, now);
                gain.gain.setValueAtTime(0.2, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 2);
                osc.start(now);
                osc.stop(now + 2);
            }
        }

        function triggerHaptic() {
            if (settings.haptic && navigator.vibrate) {
                navigator.vibrate(8); 
            }
        }

        function toggleSound() {
            settings.sound = !settings.sound;
            soundBtn.classList.toggle('active');
            soundBtn.classList.toggle('inactive');
            triggerHaptic();
            initAudio();
        }

        function toggleHaptic() {
            settings.haptic = !settings.haptic;
            hapticBtn.classList.toggle('active');
            hapticBtn.classList.toggle('inactive');
            triggerHaptic();
        }

        // --- BACK BUTTON NAVIGATION ---
        function goBack() {
            triggerHaptic();
            // Direct navigation to index.html
            window.location.href = '../index.html';
        }

        /* --- CORE LOGIC --- */
        function handleInput(value, type) {
            initAudio();
            
            if (type !== 'eq') {
                playSound('click');
                triggerHaptic();
            }

            if (type === 'num') appendNumber(value);
            if (type === 'op') chooseOperation(value);
            if (type === 'clear') clear();
            if (type === 'del') deleteNumber();
            if (type === 'eq') {
                compute();
                showCalmMessage();
                playSound('equal');
            }
        }

        function showCalmMessage() {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            quoteEl.innerText = randomQuote;
            overlay.classList.add('active');
        }

        overlay.addEventListener('click', () => {
            overlay.classList.remove('active');
        });

        /* --- MATH LOGIC --- */
        function clear() {
            currentOperand = '';
            previousOperand = '';
            operation = undefined;
            updateDisplay();
        }

        function deleteNumber() {
            currentOperand = currentOperand.toString().slice(0, -1);
            updateDisplay();
        }

        function appendNumber(number) {
            if (number === '.' && currentOperand.includes('.')) return;
            currentOperand = currentOperand.toString() + number.toString();
            updateDisplay();
        }

        function chooseOperation(op) {
            if (currentOperand === '') return;
            if (previousOperand !== '') compute();
            operation = op;
            previousOperand = currentOperand;
            currentOperand = '';
            updateDisplay();
        }

        function compute() {
            let computation;
            const prev = parseFloat(previousOperand);
            const current = parseFloat(currentOperand);
            if (isNaN(prev) || isNaN(current)) return;
            switch (operation) {
                case '+': computation = prev + current; break;
                case '-': computation = prev - current; break;
                case '*': computation = prev * current; break;
                case 'รท': computation = prev / current; break;
                default: return;
            }
            currentOperand = computation;
            operation = undefined;
            previousOperand = '';
            updateDisplay();
        }

        function updateDisplay() {
            currText.innerText = getDisplayNumber(currentOperand);
            if (operation != null) {
                prevText.innerText = `${getDisplayNumber(previousOperand)} ${operation}`;
            } else {
                prevText.innerText = '';
            }
        }

        function getDisplayNumber(number) {
            const stringNumber = number.toString();
            const integerDigits = parseFloat(stringNumber.split('.')[0]);
            const decimalDigits = stringNumber.split('.')[1];
            let integerDisplay;
            if (isNaN(integerDigits)) {
                integerDisplay = '';
            } else {
                integerDisplay = integerDigits.toLocaleString('en', { maximumFractionDigits: 0 });
            }
            if (decimalDigits != null) {
                return `${integerDisplay}.${decimalDigits}`;
            } else {
                return integerDisplay;
            }
        }
    </script>
    <script src="disable-right-click.js"></script>

</body>
</html>